<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--Title-->
    <title>SmileCare Dental Clinic</title>
    <!-- External CSS file for Login page -->
    <link rel="stylesheet" href="Login.css">
    <!-- Link to external CSS and icon libraries -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"/>
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" 
          integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    
    <!-- Header -->
    <header>
        <!-- Login icon linking to Login page -->
        <div class="Login-in">
            <a href="Login.html"><i class="ri-account-circle-line"></i></a>
        </div>
    
        <!-- Navigation menu with links -->
        <div class="navigation">
            <div class="navigation-items">
                <a href="Home.html">Home</a>
                <a href="Services.html">Services</a>
                <a href="Doctors.html">Doctors</a>
                <a href="Register.html">Register</a>
            </div>
        </div>
    
        <!-- Logo -->
        <div class="logo">
            <img src="SmileCareLogo.png">
        </div>
    
        <!-- Menu button (used for mobile toggle) -->
        <div class="menu-btn"></div>
    </header>

<script>
        // Select menu button, navigation menu, and login section from the dom
        const menuBtn = document.querySelector(".menu-btn");
        const navigation = document.querySelector(".navigation");
        const login = document.querySelector(".Login-in");
    
        // Track whether the menu is currently open or closed
        let isMenuOpen = false;
    
        // Add a click event listener to toggle the menu
        menuBtn.addEventListener("click", () => {
            isMenuOpen = !isMenuOpen;

            if (isMenuOpen) {
                // If menu is opening:
                // Add active classes to make navigation and login sections visible
                navigation.classList.add("menu-active");
                login.classList.add("menu-active");

                // Apply slide-in animation to both elements
                navigation.style.animation = "slideIn 0.4s forwards ease-in-out";
                login.style.animation = "slideInLogin 0.4s forwards ease-in-out";

                // Disable scrolling when menu is active
                document.body.classList.add("menu-active");
            } else {
                // If menu is closing:
                // Apply slide-out animation
                navigation.style.animation = "slideOut 0.4s forwards ease-in-out";
                login.style.animation = "slideOutLogin 0.4s forwards ease-in-out";

                // Remove active classes after animation finishes (400ms delay)
                setTimeout(() => {
                    navigation.classList.remove("menu-active");
                    login.classList.remove("menu-active");

                    // Re-enable scrolling when menu is closed
                    document.body.classList.remove("menu-active");
                }, 400);
            }

            // Toggle the menu button's active state (can be used for icon change)
            menuBtn.classList.toggle("menu-active");
        });
    </script>

    <!-- Login Section -->
    <section class="Login">
        <div class="container">
            <div class="box">

                <!-- Login form -->
                <form class="box-staff" id="staff">
                    <div class="top-header">
                        <h3>SmileCare</h3>
                        <small>We are happy to have you with us</small>
                    </div>

                    <div class="input-group">
                        <!-- Username input -->
                        <div class="input-field">
                            <input type="text" class="input-box" id="regUsername" required>
                            <label for="regUsername">Username</label>
                        </div>

                        <!-- Password input with toggle visibility -->
                        <div class="input-field">
                            <input type="password" class="input-box" id="log2Password" required>
                            <label for="log2Password">Password</label>
                            <div class="eye-area">
                                <div class="eye-box" onclick="myLogPassword()">
                                    <i class="fa-regular fa-eye" id="eye-2"></i>
                                    <i class="fa-regular fa-eye-slash" id="eye-slash-2"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Login button redirects to staff page -->
                        <div class="input-field">
                            <input type="submit" class="input-submit" value="Login in" required>
                        </div>
                    </div>
                </form>



            </div>
        </div>

        <!-- JavaScript for toggling views and passwords -->
        <script>
           
            function myLogPassword() {
                var d = document.getElementById("log2Password");
                var b = document.getElementById("eye-2");
                var c = document.getElementById("eye-slash-2");

                if (d.type === "password") {
                    d.type = "text";
                    b.style.opacity = "0";
                    c.style.opacity = "1";
                } else {
                    d.type = "password";
                    b.style.opacity = "1";
                    c.style.opacity = "0";
                }
            }
        </script>
    </section>

    <!-- Login Form Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loginForm = document.querySelector('.box-staff');
            
            if (loginForm) {
                console.log('Login form found, adding event listener');
                
                loginForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    console.log('Login form submitted');
                    
                    const username = document.getElementById('regUsername').value.trim();
                    const password = document.getElementById('log2Password').value.trim();

                    console.log('Username:', username);
                    console.log('Password length:', password.length);

                    if (!username || !password) {
                        alert('Please enter both username and password');
                        return;
                    }

                    try {
                        console.log('Sending login request to server...');
                        
                        const response = await fetch('http://localhost:3002/login', {
                            method: 'POST',
                            headers: { 
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            },
                            body: JSON.stringify({ username, password }),
                        });

                        console.log('Response status:', response.status);
                        console.log('Response ok:', response.ok);

                        const result = await response.json();
                        console.log('Response data:', result);

                        if (response.ok && result.success) {
                            console.log('Login successful, redirecting...');
                            alert('Login successful! Redirecting to staff dashboard...');
                            window.location.href = 'Staff-1.html';
                        } else {
                            console.log('Login failed:', result.message);
                            alert('Login failed: ' + (result.message || 'Invalid credentials'));
                        }
                    } catch (error) {
                        console.error('Login error:', error);
                        alert('Error connecting to server. Please make sure the server is running. Error: ' + error.message);
                    }
                });
            } else {
                console.error('Login form not found!');
            }
        });
    </script>

    <!-- Link to external JavaScript file -->
    <script src="JavaScript.js"></script>
</body>
</html>


